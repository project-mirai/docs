(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{751:function(t,a,e){"use strict";e.r(a);var s=e(109),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"mirai-messages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mirai-messages"}},[t._v("#")]),t._v(" Mirai - Messages")]),t._v(" "),e("h2",{attrs:{id:"目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[t._v("#")]),t._v(" 目录")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E6%B6%88%E6%81%AF%E7%B3%BB%E7%BB%9F"}},[t._v("消息系统")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B"}},[t._v("消息类型")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%B6%88%E6%81%AF%E5%85%83%E7%B4%A0"}},[t._v("消息元素")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E8%BD%AC%E4%B9%89%E8%A7%84%E5%88%99"}},[t._v("转义规则")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%B6%88%E6%81%AF%E9%93%BE%E7%9A%84-mirai-%E7%A0%81"}},[t._v("消息链的 mirai 码")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E7%94%B1-codablemessage-%E5%8F%96%E5%BE%97-mirai-%E7%A0%81%E5%AD%97%E7%AC%A6%E4%B8%B2"}},[t._v("由 "),e("code",[t._v("CodableMessage")]),t._v(" 取得 mirai 码字符串")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E7%94%B1-mirai-%E7%A0%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%96%E5%BE%97-messagechain-%E5%AE%9E%E4%BE%8B"}},[t._v("由 mirai 码字符串取得 "),e("code",[t._v("MessageChain")]),t._v(" 实例")])])])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%B6%88%E6%81%AF%E9%93%BE"}},[t._v("消息链")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"}},[t._v("发送消息")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%9E%84%E9%80%A0%E6%B6%88%E6%81%AF%E9%93%BE"}},[t._v("构造消息链")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E5%85%83%E7%B4%A0%E5%94%AF%E4%B8%80%E6%80%A7"}},[t._v("元素唯一性")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E8%8E%B7%E5%8F%96%E6%B6%88%E6%81%AF%E9%93%BE%E4%B8%AD%E7%9A%84%E6%B6%88%E6%81%AF%E5%85%83%E7%B4%A0"}},[t._v("获取消息链中的消息元素")])])])]),t._v(" "),e("li",[e("a",{attrs:{href:"#mirai-%E7%A0%81"}},[t._v("Mirai 码")])])]),t._v(" "),e("h2",{attrs:{id:"消息系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息系统"}},[t._v("#")]),t._v(" 消息系统")]),t._v(" "),e("p",[t._v("在 Contacts 章节提到，要发送消息，使用 "),e("code",[t._v("Contact.sendMessage(Message)")]),t._v("。"),e("code",[t._v("Message")]),t._v(" 架构如下图所示。")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIE1lc3NhZ2VDaGFpblxuTWVzc2FnZUNoYWluIDogTGlzdH5TaW5nbGVNZXNzYWdlflxuXG5NZXNzYWdlPHwtLU1lc3NhZ2VDaGFpblxuTWVzc2FnZTx8LS1TaW5nbGVNZXNzYWdlXG5cbk1lc3NhZ2VDaGFpbiBvLS0gU2luZ2xlTWVzc2FnZVxuXG5TaW5nbGVNZXNzYWdlPHwtLU1lc3NhZ2VDb250ZW50XG5TaW5nbGVNZXNzYWdlPHwtLU1lc3NhZ2VNZXRhZGF0YVxuXG4iLCJtZXJtYWlkIjp7InRoZW1lIjoiZGVmYXVsdCJ9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIE1lc3NhZ2VDaGFpblxuTWVzc2FnZUNoYWluIDogTGlzdH5TaW5nbGVNZXNzYWdlflxuXG5NZXNzYWdlPHwtLU1lc3NhZ2VDaGFpblxuTWVzc2FnZTx8LS1TaW5nbGVNZXNzYWdlXG5cbk1lc3NhZ2VDaGFpbiBvLS0gU2luZ2xlTWVzc2FnZVxuXG5TaW5nbGVNZXNzYWdlPHwtLU1lc3NhZ2VDb250ZW50XG5TaW5nbGVNZXNzYWdlPHwtLU1lc3NhZ2VNZXRhZGF0YVxuXG4iLCJtZXJtYWlkIjp7InRoZW1lIjoiZGVmYXVsdCJ9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ",alt:""}}),e("OutboundLink")],1)]),t._v(" "),e("p",[e("code",[t._v("SingleMessage")]),t._v(" 表示单个消息元素，"),e("code",[t._v("MessageChain")]),t._v("（消息链） 是 "),e("code",[t._v("List<SingleMessage>")]),t._v("。主动发送的消息和从服务器接收消息都是 "),e("code",[t._v("MessageChain")]),t._v("。")]),t._v(" "),e("blockquote",[e("p",[t._v("回到 "),e("a",{attrs:{href:"#%E7%9B%AE%E5%BD%95"}},[t._v("目录")])])]),t._v(" "),e("h2",{attrs:{id:"消息类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息类型"}},[t._v("#")]),t._v(" 消息类型")]),t._v(" "),e("p",[t._v("*单个消息元素（"),e("code",[t._v("SingleMessage")]),t._v("）*分为 "),e("em",[t._v("消息内容（"),e("code",[t._v("MessageContent")]),t._v("）")]),t._v(" 和 "),e("em",[t._v("消息元数据（"),e("code",[t._v("MessageMetadata")]),t._v("）")]),t._v("。")]),t._v(" "),e("p",[t._v("实践中，消息内容和消息元数据会混合存在于消息链中。")]),t._v(" "),e("blockquote",[e("p",[t._v("回到 "),e("a",{attrs:{href:"#%E7%9B%AE%E5%BD%95"}},[t._v("目录")])])]),t._v(" "),e("h2",{attrs:{id:"消息元素"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息元素"}},[t._v("#")]),t._v(" 消息元素")]),t._v(" "),e("p",[t._v("Mirai 支持富文本消息。")]),t._v(" "),e("p",[t._v("消息拥有三种转换到字符串的表示方式。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("方法")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("解释")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("serializeToMiraiCode()")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("对应的 Mirai 码. 消息的一种序列化方式，格式为 "),e("code",[t._v("[mirai:TYPE:PROP]")]),t._v("，其中 "),e("code",[t._v("TYPE")]),t._v(" 为消息类型, "),e("code",[t._v("PROP")]),t._v(" 为属性")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("contentToSting()")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("QQ 对话框中以纯文本方式会显示的消息内容。无法用纯文字表示的消息会丢失信息，如任何图片都是 "),e("code",[t._v("[图片]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("toString()")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Java 对象的 "),e("code",[t._v("toString()")]),t._v("，会尽可能包含多的信息用于调试作用，"),e("strong",[t._v("行为可能不确定")])])])])]),t._v(" "),e("p",[t._v("各类型消息元素及其 "),e("code",[t._v("contentToString()")]),t._v(" 如下表格所示。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("消息类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("解释")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[e("code",[t._v("contentToString()")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/PlainText.kt"}},[e("code",[t._v("PlainText")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("content: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("纯文本")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("$content")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Image.kt"}},[e("code",[t._v("Image")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("imageId: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("自定义图片")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[图片]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/At.kt"}},[e("code",[t._v("At")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("target: Int")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("提及某人")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("@$target")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/AtAll.kt"}},[e("code",[t._v("AtAll")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("提及全体成员")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("@全体成员")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Face.kt"}},[e("code",[t._v("Face")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("id: Int")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("原生表情")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[表情对应的中文名]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/FlashImage.kt"}},[e("code",[t._v("FlashImage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("image: Image")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("闪照")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[闪照]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/PokeMessage.kt"}},[e("code",[t._v("PokeMessage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("name: String")]),t._v(", "),e("code",[t._v("pokeType: Int")]),t._v(" , "),e("code",[t._v("id: Int")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("戳一戳消息（消息非动作）")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[戳一戳]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/VipFace.kt"}},[e("code",[t._v("VipFace")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("kind: VipFace.Kind")]),t._v(", "),e("code",[t._v("count: Int")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("VIP 表情")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[${kind.name}]x$count")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/RichMessage.kt"}},[e("code",[t._v("LightApp")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("content: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("小程序")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("$content")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Voice.kt"}},[e("code",[t._v("Voice")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("content: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("语音")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("$content")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MarketFace.kt"}},[e("code",[t._v("MarketFace")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("id: Int, name: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("商城表情")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[表情对应的中文名]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageSource.kt"}},[e("code",[t._v("MessageSource")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("消息来源元数据")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("em",[t._v("空字符串")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/QuoteReply.kt"}},[e("code",[t._v("QuoteReply")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("source: MessageSource")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("引用回复")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("em",[t._v("空字符串")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/ForwardMessage.kt"}},[e("code",[t._v("ForwardMessage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("合并转发")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[转发消息]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/RichMessage.kt"}},[e("code",[t._v("SimpleServiceMessage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("serviceId: Int, content: String")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("（不稳定）服务消息")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("$content")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MusicShare.kt"}},[e("code",[t._v("MusicShare")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("(自 2.1) 音乐分享")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[分享]曲名")])])])])]),t._v(" "),e("p",[e("strong",[t._v("请打开相关消息类型的源码查看用法。")])]),t._v(" "),e("blockquote",[e("p",[t._v("回到 "),e("a",{attrs:{href:"#%E7%9B%AE%E5%BD%95"}},[t._v("目录")])])]),t._v(" "),e("h2",{attrs:{id:"消息链"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息链"}},[t._v("#")]),t._v(" 消息链")]),t._v(" "),e("p",[t._v("前文已经介绍消息链，这里简略介绍消息链的使用。详细的使用请查看源码内注释。")]),t._v(" "),e("h3",{attrs:{id:"发送消息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发送消息"}},[t._v("#")]),t._v(" 发送消息")]),t._v(" "),e("p",[t._v("在 "),e("RouterLink",{attrs:{to:"/Contacts.html"}},[t._v("Contacts 章节")]),t._v(" 提到，要发送消息使用 "),e("code",[t._v("Contact.sendMessage")]),t._v("。"),e("code",[t._v("Contact.sendMessage")]),t._v(" 的定义是：")],1),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("suspend")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fun")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" MessageReceipt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Contact"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("要发送简单的单元素消息，使用：")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[t._v("contact"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[t._v("contact"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("要发送多元素消息，可将消息使用 "),e("code",[t._v("plus")]),t._v(" 操作连接：")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[t._v("contact"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"你要的图片是"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/f8f1ab55-bf8e-4236-b55e-955848d7069f"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个纯文本加一个图片")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[t._v("contact"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"你要的图片是："')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("plus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/f8f1ab55-bf8e-4236-b55e-955848d7069f"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个纯文本加一个图片")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"构造消息链"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构造消息链"}},[t._v("#")]),t._v(" 构造消息链")]),t._v(" "),e("p",[t._v("更复杂的消息则需要构造为消息链。")]),t._v(" "),e("h4",{attrs:{id:"在-kotlin-构造消息链"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在-kotlin-构造消息链"}},[t._v("#")]),t._v(" 在 Kotlin 构造消息链")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("定义")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun Iterable<Messaged>.toMessageChain(): MessageChain")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun Sequence<Messaged>.toMessageChain(): MessageChain")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun Array<Message>.toMessageChain(): MessageChain")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun Message.toMessageChain(): MessageChain")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun messageChainOf(vararg Message): MessageChain")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("fun Message.plus(tail: Message): MessageChain")])])])])]),t._v(" "),e("p",[t._v("可以使用如上表格所示的方法构造，或使用 DSL builder。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("class MessageChainBuilder : MutableList<SingleMessage>, Appendable {\n    operator fun Message.unaryPlus()\n    operator fun String.unaryPlus()\n    fun add(vararg messages: Message)\n}\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buildMessageChain "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("AtAll\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/f8f1ab55-bf8e-4236-b55e-955848d7069f"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("At")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// chain 结果是包含 PlainText, AtAll, Image, At 的 MessageChain")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("h4",{attrs:{id:"在-java-构造消息链"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在-java-构造消息链"}},[t._v("#")]),t._v(" 在 Java 构造消息链")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("定义")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("public static MessageChain newChain(Iterable<Message> iterable)")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("public static MessageChain newChain(Message iterable...)")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("public static MessageChain newChain(Iterator<Message> iterable...)")])])])])]),t._v(" "),e("p",[t._v("方法都位于 "),e("code",[t._v("net.mamoe.mirai.message.data.MessageUtils")]),t._v("。")]),t._v(" "),e("p",[t._v("使用 "),e("code",[t._v("MessageChainBuilder")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageChain")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageChainBuilder")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PlainText")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会被构造成 PlainText 再添加, 相当于上一行")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtAll")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("INSTANCE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/f8f1ab55-bf8e-4236-b55e-955848d7069f"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("h3",{attrs:{id:"元素唯一性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#元素唯一性"}},[t._v("#")]),t._v(" 元素唯一性")]),t._v(" "),e("p",[t._v("部分元素只能单一存在于消息链中。这样的元素实现接口 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Message.kt#L273-L287"}},[e("code",[t._v("ConstrainSingle")])]),t._v("。")]),t._v(" "),e("p",[t._v("唯一的元素例如 "),e("em",[t._v("消息元数据")]),t._v(" "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageSource.kt"}},[e("code",[t._v("MessageSource")])]),t._v("，在连接时，新的（右侧）元素会替换旧的（左侧）元素。如：")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" source1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" MessageSource\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" source2"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" MessageSource\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" MessageChain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" source1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" source2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 结果 chain 只包含一个元素，即右侧的 source2。")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("p",[t._v("元素唯一性的识别基于 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageKey.kt"}},[e("code",[t._v("MessageKey")])]),t._v("。"),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageKey.kt"}},[e("code",[t._v("MessageKey")])]),t._v(" 拥有多态机制。元素替换时会替换。如 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/HummerMessage.kt"}},[e("code",[t._v("HummerMessage")])]),t._v(" 的继承关系")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("              MessageContent\n                    ↑\n              HummerMessage\n                    ↑\n       +------------+-------------+------------+\n       |            |             |            |\n PokeMessage     VipFace      FlashImage      ...\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("p",[t._v("当连接一个 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/VipFace.kt"}},[e("code",[t._v("VipFace")])]),t._v(" 到一个 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageChain.kt"}},[e("code",[t._v("MessageChain")])]),t._v(" 时，由于 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/VipFace.kt"}},[e("code",[t._v("VipFace")])]),t._v(" 最上层为 "),e("code",[t._v("MessageContent")]),t._v("，消息链中第一个 "),e("code",[t._v("MessageContent")]),t._v(" 会被（保留顺序地）替换为 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/VipFace.kt"}},[e("code",[t._v("VipFace")])]),t._v("，其他所有 "),e("code",[t._v("MessageContent")]),t._v(" 都会被删除。")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("messageChainOf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quoteReply"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plainText"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" at"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" atAll"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// quoteReply 是 MessageMetadata, 其他三个都是 MessageContent")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("VipFace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VipFace"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AiXin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// VipFace 是 ConstrainSingle，最上层键为 MessageContent，因此替换所有的 MessageContent")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 结果为 [quoteReply, VipFace]")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h3",{attrs:{id:"获取消息链中的消息元素"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取消息链中的消息元素"}},[t._v("#")]),t._v(" 获取消息链中的消息元素")]),t._v(" "),e("h4",{attrs:{id:"a-筛选-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-筛选-list"}},[t._v("#")]),t._v(" A. 筛选 List")]),t._v(" "),e("p",[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageChain.kt"}},[e("code",[t._v("MessageChain")])]),t._v(" 继承接口 "),e("code",[t._v("List<SingleMessage>")]),t._v("。")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filterIsInstance"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("firstOrNull")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),t._v(" image "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("stream")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isInstance")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("findFirst")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("orElse")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("在 Kotlin 要获取第一个指定类型实例还可以使用快捷扩展。")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("findIsInstance"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("firstIsInstance"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不存在时 NoSuchElementException")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h4",{attrs:{id:"b-获取唯一消息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#b-获取唯一消息"}},[t._v("#")]),t._v(" B. 获取唯一消息")]),t._v(" "),e("p",[t._v("如果要获取 "),e("code",[t._v("ConstrainSingle")]),t._v(" 的消息元素，可以快速通过键获得。")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" quote"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" QuoteReply"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("QuoteReply"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 类似 Map.get")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" quote"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" QuoteReply "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOrFail")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("QuoteReply"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不存在时 NoSuchElementException")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("QuoteReply")]),t._v(" quote "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("QuoteReply"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("blockquote",[e("p",[t._v("这是因为 "),e("code",[t._v("MessageKey")]),t._v(" 一般都以消息元素的 "),e("code",[t._v("companion object")]),t._v(" 实现")])]),t._v(" "),e("h4",{attrs:{id:"c-使用属性委托"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#c-使用属性委托"}},[t._v("#")]),t._v(" C. 使用属性委托")]),t._v(" "),e("p",[t._v("可在 Kotlin 使用属性委托。这样的方法与上述方法在性能上等价。")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不存在时 NoSuchElementException")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("orNull")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Image"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" chain"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("orElse")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 返回一个 Image */")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h3",{attrs:{id:"序列化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#序列化"}},[t._v("#")]),t._v(" 序列化")]),t._v(" "),e("p",[t._v("消息可以序列化为 JSON 字符串，使用 "),e("code",[t._v("MessageChain.serializeToJsonString")]),t._v(" 和 "),e("code",[t._v("MessageChain.deserializeFromJsonString")]),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"mirai-码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mirai-码"}},[t._v("#")]),t._v(" Mirai 码")]),t._v(" "),e("p",[t._v("实现了接口 "),e("code",[t._v("CodableMessage")]),t._v(" 的消息类型支持 mirai 码表示。")]),t._v(" "),e("h3",{attrs:{id:"转义规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#转义规则"}},[t._v("#")]),t._v(" 转义规则")]),t._v(" "),e("p",[t._v("mirai 码内的属性字符串会被转义。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("原字符")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("转义结果字符")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("[")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\[")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("]")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v(":")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\:")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v(",")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\,")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\\\")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("em",[t._v("换行符 \\n")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\n")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("em",[t._v("换行符 \\r")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("\\r")])])])])]),t._v(" "),e("h3",{attrs:{id:"消息链的-mirai-码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息链的-mirai-码"}},[t._v("#")]),t._v(" 消息链的 mirai 码")]),t._v(" "),e("p",[t._v("消息链 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageChain.kt"}},[e("code",[t._v("MessageChain")])]),t._v(" 是多个 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Message.kt"}},[e("code",[t._v("SingleMessage")])]),t._v(" 的集合。"),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/MessageChain.kt"}},[e("code",[t._v("MessageChain")])]),t._v(" 也实现 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/code/CodableMessage.kt"}},[e("code",[t._v("CodableMessage")])]),t._v("。在转换为 mirai 码时所有 "),e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/code/CodableMessage.kt"}},[e("code",[t._v("CodableMessage")])]),t._v(" 直接相连：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('val chain = messageChainOf(PlainText("plain"), At(123), AtAll)\n\nchain.serializeToMiraiCode() // "plain[mirai:at:123][mirai:atall]"\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h3",{attrs:{id:"由-codablemessage-取得-mirai-码字符串"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#由-codablemessage-取得-mirai-码字符串"}},[t._v("#")]),t._v(" 由 "),e("code",[t._v("CodableMessage")]),t._v(" 取得 mirai 码字符串")]),t._v(" "),e("p",[t._v("通过 "),e("code",[t._v("CodableMessage.serializeToMiraiCode()")]),t._v("。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("val at = At(123)\n\nat.serializeToMiraiCode() // 结果为 `[mirai:at:123]`\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("消息类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[e("code",[t._v("serializeToMiraiCode()")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/PlainText.kt"}},[e("code",[t._v("PlainText")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("$content")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Image.kt"}},[e("code",[t._v("Image")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:image:$imageId]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/At.kt"}},[e("code",[t._v("At")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:at:$target]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/AtAll.kt"}},[e("code",[t._v("AtAll")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:atall]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/Face.kt"}},[e("code",[t._v("Face")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:face:id]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/FlashImage.kt"}},[e("code",[t._v("FlashImage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:flash:${image.imageId}]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/PokeMessage.kt"}},[e("code",[t._v("PokeMessage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:poke:$name,$pokeType,$id]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/VipFace.kt"}},[e("code",[t._v("VipFace")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:vipface:${kind.id},${kind.name},$count]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/RichMessage.kt"}},[e("code",[t._v("LightApp")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:app:$content]")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("a",{attrs:{href:"../mirai-core-api/src/commonMain/kotlin/message/data/RichMessage.kt"}},[e("code",[t._v("SimpleServiceMessage")])])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("[mirai:service:$serviceId,$content]")])])])])]),t._v(" "),e("h3",{attrs:{id:"由-mirai-码字符串取得-messagechain-实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#由-mirai-码字符串取得-messagechain-实例"}},[t._v("#")]),t._v(" 由 mirai 码字符串取得 "),e("code",[t._v("MessageChain")]),t._v(" 实例")]),t._v(" "),e("div",{staticClass:"language-kotlin line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-kotlin"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[mirai:atall]"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("deserializeMiraiCode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageChain")]),t._v(" chain "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MiraiCode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("deserializeFromMiraiCode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[mirai:atall]"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("hr"),t._v(" "),e("p",[t._v("到这里，你已经完成了 Mirai 所有文档的阅读。现在你已经熟悉了 Mirai，并可以开始使用了。")]),t._v(" "),e("p",[t._v("你可以首先构造 Bot，登录，然后从监听事件起开始创建你的机器人，或从 Bot 获取到指定群主动发送消息。在使用中遇到问题可以参考 Mirai 源码内注释，该注释会包含更多实践上的帮助。")]),t._v(" "),e("p",[t._v("如果你仍然对 Mirai 架构有不明确的地方，欢迎在 "),e("a",{attrs:{href:"https://github.com/mamoe/mirai/discussions/848",target:"_blank",rel:"noopener noreferrer"}},[t._v("#848"),e("OutboundLink")],1),t._v(" 提出建议，或者直接在 PR 提交你的修改。")]),t._v(" "),e("blockquote",[e("p",[t._v("回到 "),e("a",{attrs:{href:"#%E7%9B%AE%E5%BD%95"}},[t._v("目录")])]),t._v(" "),e("p",[e("RouterLink",{attrs:{to:"/#mirai-core-api-文档"}},[t._v("回到 Mirai 文档索引")])],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);